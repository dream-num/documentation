import { Callout, Tabs } from 'nextra/components'
import Showcase from '@/showcase/sheets/basic'

# å®‰è£…å’ŒåŸºæœ¬ä½¿ç”¨

Univer æœ‰ç€æ’ä»¶åŒ–çš„è®¾è®¡ï¼Œæˆ‘ä»¬æä¾›äº†ä¸°å¯Œçš„æ’ä»¶ï¼Œä»¥ä¾¿è®©ä½ æ›´åŠ çµæ´»åœ°æ„å»ºå‡ºå±äºè‡ªå·±çš„ç”µå­æ–‡æ¡£åº”ç”¨ã€‚ä½ å¯ä»¥æ ¹æ®è‡ªèº«éœ€æ±‚é€‰æ‹©æ€§åœ°æ‰‹åŠ¨ç»„åˆå¼•å…¥å¹¶ä½¿ç”¨è¿™äº›æ’ä»¶ã€‚

ä» 0.5.0 ç‰ˆæœ¬èµ· Univer æä¾›äº† `@univerjs/presets` åŒ…ï¼Œå¯ä»¥å¸®åŠ©ä½ å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ª Univer åº”ç”¨è€Œæ— éœ€å…³å¿ƒæ’ä»¶åŒ–çš„è®¾è®¡ä»¥åŠå¦‚ä½•å¼•å…¥å’Œé…ç½®æ³¨å†Œé‚£äº›ç¹æ‚çš„æ’ä»¶ã€‚å› æ­¤ï¼Œ**å¦‚æœä½ æ˜¯é¦–æ¬¡ä½¿ç”¨ Univer çš„å¼€å‘è€…ï¼Œæˆ‘ä»¬æ¨èä½ ä» Presets å¼€å§‹ã€‚**

<Callout type="warning">
  éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ— è®ºæ˜¯ä½¿ç”¨ Presets åŒ…è¿˜æ˜¯æ‰‹åŠ¨ç»„åˆå®‰è£…çš„æ–¹å¼ï¼Œä½ éƒ½**å¿…é¡»ä¿è¯æ‰€æœ‰çš„ preset æˆ–æ’ä»¶ç‰ˆæœ¬å·ä¸€è‡´**ã€‚
</Callout>

æœ¬ç« å°†å¸¦ä½ äº†è§£å¦‚ä½•ä½¿ç”¨ Univer çš„ Presets åŒ…æˆ–è€…é€šè¿‡æ‰‹åŠ¨ç»„åˆå®‰è£…æ’ä»¶çš„æ–¹å¼æ¥æ„å»ºä¸€ä¸ªæœ€åŸºæœ¬çš„ Univer Sheets åº”ç”¨ã€‚

## ä½¿ç”¨ Presets

Univer Presets åŸºäºç”µå­æ–‡æ¡£çš„åŠŸèƒ½åœºæ™¯ï¼Œæä¾›äº†ä¸€ç³»åˆ—çš„æ’ä»¶ç»„åˆï¼Œä»¥ä¾¿è®©ä½ å¿«é€Ÿåœ°æ­å»ºä¸€ä¸ª Univer åº”ç”¨ã€‚ä¸€ä¸ª preset ä¸­é€šå¸¸åŒ…å«åŒ…å«äº†æ’ä»¶ã€æ ·å¼æ–‡ä»¶ã€è¯­è¨€åŒ…ã€Facade APIã€‚

åœ¨è¿™é‡Œæˆ‘ä»¬å°†ç®€å•ä»‹ç»ä¸‹å¦‚ä½•é€šè¿‡ä¸åˆ°äºŒåè¡Œçš„ä»£ç æ¥å¿«é€Ÿæ­å»ºä¸€ä¸ª Univer Sheets åº”ç”¨ã€‚

### ä½¿ç”¨åŒ…ç®¡ç†å™¨

å¦‚æœä½ çš„é¡¹ç›®ä¸­å·²ç»å¼•å…¥äº†ç°ä»£å‰ç«¯å¼€å‘å·¥å…·ï¼Œé‚£ä¹ˆå¼•å…¥ Univer å°†ä¼šéå¸¸ç®€å•ã€‚æˆ‘ä»¬æ¨èä½¿ç”¨ [Vite](https://vitejs.dev/)ã€[esbuild](https://esbuild.github.io/) æˆ– [Webpack 5](https://webpack.js.org/) ç­‰å¯¹ ES Module æ”¯æŒè¾ƒå¥½çš„æ„å»ºå·¥å…·æ¥æ„å»º Univer åº”ç”¨ã€‚å¦‚æœä½ ä½¿ç”¨äº†å…¶å®ƒæ„å»ºå·¥å…·ï¼ˆä¾‹å¦‚ Webpack 4ï¼‰ï¼Œå¯èƒ½ä¼šéœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®ï¼Œè¯·é˜…è¯» [å¸¸è§é—®é¢˜](/guides/sheets/troubleshooting) è·å–æ›´å¤šä¿¡æ¯ã€‚

#### å®‰è£…

é€‰æ‹©ä½ æ‰€ä½¿ç”¨çš„åŒ…ç®¡ç†å™¨ä»¥å®‰è£… `@unvierjs/presets`ï¼š

```shell npm2yarn
npm install @univerjs/presets
```

#### ä½¿ç”¨

é€šè¿‡ä»¥ä¸‹ä»£ç ï¼Œä½ å°±å¯ä»¥å¯åŠ¨ä¸€ä¸ª Univer Sheets åº”ç”¨ï¼š

<Callout type="warning">
  å¦‚æœä½ çš„æ„å»ºå·¥å…·ä¸æ”¯æŒ package.json çš„ `exports` å­—æ®µï¼ˆå¸¸è§äº Webpack 4ï¼‰ï¼Œä½ éœ€è¦æ‰‹åŠ¨å°†æ˜ å°„çš„è·¯å¾„ä¿®æ”¹ä¸ºå®é™…çš„è·¯å¾„ã€‚
</Callout>

```typescript
import { createUniver, defaultTheme, LocaleType, merge } from '@univerjs/presets';
import { UniverSheetsCorePreset } from '@univerjs/presets/preset-sheets-core';
import UniverPresetSheetsCoreZhCN from '@univerjs/presets/preset-sheets-core/locales/zh-CN';

import '@univerjs/presets/lib/styles/preset-sheets-core.css';

const { univer, univerAPI } = createUniver({
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: merge(
      {},
      UniverPresetSheetsCoreZhCN,
    ),
  },
  theme: defaultTheme,
  presets: [
    UniverSheetsCorePreset({
      container: 'app',
    }),
  ],
});

univerAPI.createWorkbook({ name: 'Test Sheet' });
```

è®°å¾—ä¸ºå®¹å™¨å…ƒç´ è®¾ç½®ä¸€ä¸ªé«˜åº¦ï¼Œä»¥ä¾¿ Univer èƒ½å¤Ÿæ­£ç¡®åœ°æ¸²æŸ“ï¼Œæ¯”å¦‚ï¼š

```html
<style>
  html,
  body,
  #root,
  #app {
    padding: 0;
    margin: 0;
    height: 100%;
  }
</style>
```

è¿™æ˜¯ä¸€ä¸ªåŸºç¡€çš„ä¾‹å­

<Showcase lang="zh-CN" toolbar={{ showCode: true }} />

##### `createUniver` æ–¹æ³•

`createUniver` æ–¹æ³•æ¥å—ä¸€ä¸ªé…ç½®å¯¹è±¡ï¼Œå…¶ä¸­åŒ…å«äº† Univer çš„é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚è¯­è¨€ã€ä¸»é¢˜ã€æ’ä»¶ç­‰ã€‚è¿™ä¸ªæ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªåŒ…å«äº† Univer å®ä¾‹å’Œ Univer Facade API å®ä¾‹çš„å¯¹è±¡ã€‚

é…ç½®å¯¹è±¡çš„å±æ€§å¦‚ä¸‹ï¼š

- `locale`ï¼šè¯­è¨€ç¯å¢ƒï¼Œå¯ä»¥æ˜¯ `LocaleType` æšä¸¾å€¼ã€‚
- `locales`ï¼šè¯­è¨€åŒ…ï¼Œä¸€ä¸ªå¯¹è±¡ï¼Œé”®ä¸ºè¯­è¨€ç¯å¢ƒï¼Œå€¼ä¸ºè¯­è¨€åŒ…å¯¹è±¡ã€‚
- `theme`ï¼šä¸»é¢˜ï¼Œä¸€ä¸ªä¸»é¢˜å¯¹è±¡ã€‚
- `presets`ï¼šä¸€ä¸ª preset æ•°ç»„ï¼ŒåŒ…å«äº†éœ€è¦æ³¨å†Œçš„é¢„è®¾åŒ…ï¼Œä¾‹å¦‚ `UniverSheetsCorePreset`ã€‚
- `plugins`ï¼šä¸€ä¸ªæ’ä»¶æ•°ç»„ï¼ŒåŒ…å«äº†éœ€è¦é¢å¤–æ³¨å†Œçš„æ’ä»¶ã€‚

å½“ä½ ä½¿ç”¨äº†ä¸€ä¸ªæœªåŒ…å«åœ¨ä»»ä½•é¢„è®¾åŒ…ä¸­çš„æ’ä»¶æˆ–è€…ä½ è‡ªå·±å®ç°äº†ä¸€ä¸ªæ’ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡ `plugins` å±æ€§æ¥æ³¨å†Œè¿™äº›æ’ä»¶ã€‚ä¹Ÿå¯ä»¥é€‰æ‹©åœ¨è·å¾— Univer å®ä¾‹åé€šè¿‡ `univer.registerPlugin` æ–¹æ³•æ¥æ³¨å†Œæ’ä»¶ã€‚

### é€šè¿‡ `<script>` æ ‡ç­¾å¼•å…¥

å¦‚æœä½ ä¸ä½¿ç”¨åŒ…ç®¡ç†å·¥å…·ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡ `<script>` æ ‡ç­¾å¼•å…¥ Univerã€‚

æˆ‘ä»¬åœ¨å½“å‰ä¸»æµçš„ CDN æœåŠ¡å•†ï¼ˆä¾‹å¦‚ jsDelivrã€unpkgï¼‰éƒ½æä¾›äº† Univer çš„ UMD æ„å»ºï¼Œä½ å¯ä»¥åœ¨ HTML æ–‡ä»¶ä¸­å¼•å…¥è¿™äº›èµ„æºï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸‹è½½è¿™äº›æ–‡ä»¶ç„¶åé€šè¿‡è‡ªå·±çš„æœåŠ¡å™¨æˆ–è€… CDN ç½‘ç»œåˆ†å‘ï¼‰ï¼š

#### ç¤ºä¾‹

```html
<head>
  <script src="https://unpkg.com/react@18.3.1/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/rxjs/dist/bundles/rxjs.umd.min.js"></script>
  <script src="https://unpkg.com/echarts@5.6.0/dist/echarts.min.js"></script>

  <script src="https://unpkg.com/@univerjs/presets/lib/umd/index.js"></script>
  
  <script src="https://unpkg.com/@univerjs/preset-sheets-core/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/preset-sheets-core/lib/umd/locales/zh-CN.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/@univerjs/preset-sheets-core/lib/index.css" />
  <style>
    html,
    body,
    #root,
    #app {
      padding: 0;
      margin: 0;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="app"></div>
 
  <script>
    const { createUniver } = UniverPresets;
    const { LocaleType, merge } = UniverCore;
    const { defaultTheme } = UniverDesign;
    const { UniverSheetsCorePreset } = UniverPresetSheetsCore

    const { univerAPI } = createUniver({
      locale: LocaleType.ZH_CN,
      locales: {
        [LocaleType.ZH_CN]: merge(
          {},
          UniverPresetSheetsCoreZhCN,
        ),
      },
      theme: defaultTheme,
      presets: [
        UniverSheetsCorePreset(),
      ],
    });

    univerAPI.createWorkbook({ name: 'Test Sheet' }); // åˆ›å»ºä¸€ä¸ªåä¸º 'Test Sheet' çš„å·¥ä½œè¡¨
  </script>
</body>
```

è¿™é‡Œè¿”å›çš„ `univerAPI` å¯¹è±¡è¢«ç§°ä¸º Univer çš„é¢æ¿ APIï¼ˆFacade APIï¼‰ï¼Œé€šè¿‡å®ƒå¯ä»¥è°ƒç”¨ Univer æä¾›çš„è®¸å¤šåŠŸèƒ½ã€‚

#### æŒ‡å®šç‰ˆæœ¬

unpkg å’Œ jsDeliver éƒ½æ”¯æŒæŒ‡å®šç‰¹å®šç‰ˆæœ¬çš„èµ„æºã€‚ä»¥ unpkg ä¸ºä¾‹ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨ 0.5.0 ç‰ˆæœ¬çš„ Univerï¼Œä»…éœ€åœ¨ URL ä¸­åŠ ä¸Š `@<version>` æ¥æŒ‡å®šç‰ˆæœ¬å³å¯ï¼š

```diff
- https://unpkg.com/@univerjs/presets/lib/umd/index.js
+ https://unpkg.com/@univerjs/presets@0.5.0/lib/umd/index.js
```

## æ‰‹åŠ¨ç»„åˆå®‰è£…æ’ä»¶

å½“ä½ éœ€è¦æ›´åŠ çµæ´»åœ°æ§åˆ¶æ’ä»¶çš„åŠ è½½æ—¶æœºï¼Œæˆ–è€…æƒ³è¦æ›´åŠ ç»†ç²’åº¦åœ°æŒ‰éœ€å¼•å…¥æ’ä»¶æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©æ‰‹åŠ¨ç»„åˆå®‰è£…æ’ä»¶ã€‚è¿™é‡Œä»…ä»¥æœ€åŸºç¡€çš„ Univer Sheets åº”ç”¨ä¸ºä¾‹ï¼Œä»‹ç»å¦‚ä½•é€šè¿‡æ‰‹åŠ¨ç»„åˆçš„æ–¹å¼å®‰è£…æ’ä»¶ã€‚

ä¸ Presets ä¸åŒï¼Œæ‰‹åŠ¨ç»„åˆå®‰è£…æ’ä»¶é»˜è®¤å¹¶ä¸åŒ…å« Facade APIï¼Œä»¥ä¸‹ä»£ç ç¤ºä¾‹ä¸­æœ‰å…³ Facade API çš„éƒ¨åˆ†éƒ½æ˜¯å¯é€‰çš„ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥å†³å®šæ˜¯å¦åˆ é™¤ã€‚

### ä½¿ç”¨åŒ…ç®¡ç†å™¨

#### å®‰è£…

Univer ä½¿ç”¨äº† React å¼€å‘è§†å›¾ï¼ˆå½“ç„¶è¿™å¹¶ä¸å½±å“ä½ åœ¨ Vue æˆ–è€… Angular ä¸­ä½¿ç”¨ Univerï¼‰ï¼Œä½¿ç”¨ Rxjs æ¥å¤„ç†æ•°æ®æµï¼Œç”±äºè¿™ä¸¤ä¸ªåº“è¢«å¹¿æ³›ä½¿ç”¨åœ¨ç°ä»£å‰ç«¯å¼€å‘ä¸­ï¼Œå› æ­¤æˆ‘ä»¬å°†å®ƒä»¬ä½œä¸º peerDependenciesã€‚è€Œä¸åŒçš„åŒ…ç®¡ç†å·¥å…·åœ¨å¯¹äº peerDependencies æœ‰ç€ä¸åŒçš„è¡Œä¸ºç­–ç•¥ï¼Œå› æ­¤ä½ å¯èƒ½éœ€è¦æ³¨æ„ä¸€äº›ç»†èŠ‚ã€‚

<Callout>
  - å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ npmï¼Œè¯·ç¡®ä¿ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º npm@7 åŠä»¥ä¸Šã€‚è¿™æ˜¯å› ä¸º npm@3 ~ npm@6 å¹¶ä¸ä¼šæ­£ç¡®åœ°å®‰è£… `peerDependencies`[^1]ã€‚
  - å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ pnpmï¼Œè¯·ç¡®ä¿ä½¿ç”¨çš„ç‰ˆæœ¬ä¸º pnpm@8 åŠä»¥ä¸Šã€‚å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ pnpm@6 ~ pnpm@7ï¼Œå¯ä»¥å°è¯•é…ç½® `auto-install-peers=true` [^2]æ¥è§£å†³ä¾èµ–å®‰è£…é—®é¢˜ã€‚
  - å¦‚æœä½ æ­£åœ¨ä½¿ç”¨ yarnï¼Œä½ éœ€è¦æ‰‹åŠ¨å®‰è£…ç¼ºå¤±çš„ `peerDependencies`[^3]ï¼Œä¸è¿‡åˆ«æ‹…å¿ƒï¼Œä¸‹é¢çš„å®‰è£…å‘½ä»¤ä¸­å·²ç»åŒ…å«äº†è¿™äº›ä¾èµ–ã€‚
</Callout>

<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tabs.Tab>
    ```shell
    npm install @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/sheets @univerjs/sheets-formula @univerjs/sheets-formula-ui @univerjs/sheets-numfmt @univerjs/sheets-numfmt-ui @univerjs/sheets-ui @univerjs/ui
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```shell
    pnpm add @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/sheets @univerjs/sheets-formula @univerjs/sheets-formula-ui @univerjs/sheets-numfmt @univerjs/sheets-numfmt-ui @univerjs/sheets-ui @univerjs/ui
    ```
  </Tabs.Tab>
  <Tabs.Tab>
    ```shell
    yarn add @univerjs/core @univerjs/design @univerjs/docs @univerjs/docs-ui @univerjs/engine-formula @univerjs/engine-render @univerjs/sheets @univerjs/sheets-formula @univerjs/sheets-formula-ui @univerjs/sheets-numfmt @univerjs/sheets-numfmt-ui @univerjs/sheets-ui @univerjs/ui react react-dom rxjs
    ```
  </Tabs.Tab>
</Tabs>

#### ä½¿ç”¨ [#usage]

<Callout>
  æ ·å¼æ–‡ä»¶çš„å¼•å…¥é¡ºåºå¾ˆé‡è¦ï¼Œç¡®ä¿ä½ åœ¨ä¾æ¬¡å¼•å…¥ `@univerjs/design`ã€`@univerjs/ui` çš„ CSS æ ·å¼åå†å¼•å…¥å…¶ä»–æ’ä»¶çš„æ ·å¼æ–‡ä»¶ã€‚
</Callout>

ä½ éœ€è¦åœ¨é¡¹ç›®ä¸­å¼•å…¥ Univer çš„æ ·å¼æ–‡ä»¶ã€è¯­è¨€åŒ…ï¼Œä»¥åŠä¸€äº›å¿…è¦çš„æ’ä»¶ï¼š

```typescript
import { LocaleType, merge, Univer, UniverInstanceType } from "@univerjs/core";
import { FUniver } from "@univerjs/core/facade";
import { defaultTheme } from "@univerjs/design";

import { UniverFormulaEnginePlugin } from "@univerjs/engine-formula";
import { UniverRenderEnginePlugin } from "@univerjs/engine-render";
import { UniverUIPlugin } from "@univerjs/ui";
import { UniverDocsPlugin } from "@univerjs/docs";
import { UniverDocsUIPlugin } from "@univerjs/docs-ui";
import { UniverSheetsPlugin } from "@univerjs/sheets";
import { UniverSheetsUIPlugin } from "@univerjs/sheets-ui";
import { UniverSheetsFormulaPlugin } from "@univerjs/sheets-formula";
import { UniverSheetsFormulaUIPlugin } from "@univerjs/sheets-formula-ui";
import { UniverSheetsNumfmtPlugin } from "@univerjs/sheets-numfmt";
import { UniverSheetsNumfmtUIPlugin } from "@univerjs/sheets-numfmt-ui";

import DesignZhCN from '@univerjs/design/locale/zh-CN';
import UIZhCN from '@univerjs/ui/locale/zh-CN';
import DocsUIZhCN from '@univerjs/docs-ui/locale/zh-CN';
import SheetsZhCN from '@univerjs/sheets/locale/zh-CN';
import SheetsUIZhCN from '@univerjs/sheets-ui/locale/zh-CN';
import SheetsFormulaUIZhCN from '@univerjs/sheets-formula-ui/locale/zh-CN';
import SheetsNumfmtUIZhCN from '@univerjs/sheets-numfmt-ui/locale/zh-CN';

// è¿™é‡Œçš„ Facade API æ˜¯å¯é€‰çš„ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„éœ€æ±‚æ¥å†³å®šæ˜¯å¦å¼•å…¥
import '@univerjs/engine-formula/facade';
import '@univerjs/ui/facade';
import '@univerjs/docs-ui/facade';
import '@univerjs/sheets/facade';
import '@univerjs/sheets-ui/facade';
import '@univerjs/sheets-formula/facade';
import '@univerjs/sheets-numfmt/facade';

import "@univerjs/design/lib/index.css";
import "@univerjs/ui/lib/index.css";
import "@univerjs/docs-ui/lib/index.css";
import "@univerjs/sheets-ui/lib/index.css";
import "@univerjs/sheets-formula-ui/lib/index.css";
import "@univerjs/sheets-numfmt-ui/lib/index.css";
```

ç„¶ååˆ›å»ºä¸€ä¸ª Univer å®ä¾‹ï¼Œå¹¶æ³¨å†Œè¿™äº›æ’ä»¶ï¼š

```typescript
const univer = new Univer({
  theme: defaultTheme,
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: merge(
      {},
      DesignZhCN,
      UIZhCN,
      DocsUIZhCN,
      SheetsZhCN,
      SheetsUIZhCN,
      SheetsFormulaUIZhCN,
      SheetsNumfmtUIZhCN
    ),
  },
});

univer.registerPlugin(UniverRenderEnginePlugin);
univer.registerPlugin(UniverFormulaEnginePlugin);

univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
});

univer.registerPlugin(UniverDocsPlugin);
univer.registerPlugin(UniverDocsUIPlugin);

univer.registerPlugin(UniverSheetsPlugin);
univer.registerPlugin(UniverSheetsUIPlugin);
univer.registerPlugin(UniverSheetsFormulaPlugin);
univer.registerPlugin(UniverSheetsFormulaUIPlugin);
univer.registerPlugin(UniverSheetsNumfmtPlugin);
univer.registerPlugin(UniverSheetsNumfmtUIPlugin);

univer.createUnit(UniverInstanceType.UNIVER_SHEET, {});

const univerAPI = FUniver.newAPI(univer);
```

#### æ‡’åŠ è½½éƒ¨åˆ†æ’ä»¶

ä½¿ç”¨æ‰‹åŠ¨ç»„åˆå®‰è£…æ–¹å¼çš„ä¸€ä¸ªä¼˜åŠ¿æ˜¯ä½ å¯ä»¥æ›´åŠ çµæ´»åœ°æ§åˆ¶æ’ä»¶çš„åŠ è½½æ—¶æœºï¼Œä¸€ç§å¸¸è§çš„æ–¹å¼æ˜¯åœ¨åº”ç”¨åˆå§‹åŒ–æ—¶ä»…åŠ è½½å¿…é¡»çš„æ’ä»¶ï¼Œè€Œå°†éƒ¨åˆ†æ’ä»¶çš„åŠ è½½æ—¶æœºå»¶è¿Ÿåˆ°é¦–æ¬¡æ¸²æŸ“å®Œæˆä¹‹åã€‚

Univer çš„ [å®˜æ–¹ demo](https://github.com/dream-num/univer/blob/dev/examples/src/sheets/main.ts) å°±ä½¿ç”¨äº†è¿™æ ·çš„ä¼˜åŒ–æŠ€å·§ï¼Œå¯ä¾›å‚è€ƒã€‚

### é€šè¿‡ `<script>` æ ‡ç­¾å¼•å…¥

å’Œ Presets ä¸€æ · Univer ä¹Ÿä¸ºæ¯ä¸ªæ’ä»¶éƒ½æä¾›äº† UMD åŒ…ï¼Œä½†ä¸ä¹‹ä¸åŒçš„æ˜¯ï¼Œä½ éœ€è¦æ‰‹åŠ¨å¼•å…¥æ¯ä¸ªæ’ä»¶çš„ UMD åŒ…ã€‚è¿™ä¸ªè¿‡ç¨‹éå¸¸ç¹çï¼Œæˆ‘ä»¬å¹¶**ä¸æ¨è**è¿™ç§æ–¹å¼ã€‚è¯·åœ¨å®Œå…¨ç†è§£æ’ä»¶æœºåˆ¶ï¼ˆå¦‚æ’ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œä»¥åŠæ’ä»¶æ ·å¼æ–‡ä»¶çš„å¼•å…¥é¡ºåºï¼‰ä¹‹åå†è€ƒè™‘ä½¿ç”¨ã€‚

#### ç¤ºä¾‹

æˆ‘ä»¬åœ¨å½“å‰ä¸»æµçš„ CDN æœåŠ¡å•†ï¼ˆä¾‹å¦‚ jsDelivrã€unpkgï¼‰éƒ½æä¾›äº† Univer çš„ UMD æ„å»ºï¼Œä½ å¯ä»¥åœ¨ HTML æ–‡ä»¶ä¸­å¼•å…¥è¿™äº›èµ„æºï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä¸‹è½½è¿™äº›æ–‡ä»¶ç„¶åé€šè¿‡è‡ªå·±çš„æœåŠ¡å™¨æˆ–è€… CDN ç½‘ç»œåˆ†å‘ï¼‰ï¼š

```html
<head>
  <script src="https://unpkg.com/react@18.3.1/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18.3.1/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/rxjs@7.8.1/dist/bundles/rxjs.umd.min.js"></script>
  <script src="https://unpkg.com/echarts@5.6.0/dist/echarts.min.js"></script>
  <script src="https://unpkg.com/@wendellhu/redi/dist/redi.js"></script>
  <script src="https://unpkg.com/@wendellhu/redi/dist/react-bindings.js"></script>

  <script>
    /**
     * Starting from Univer 0.6.0, with the support for React 19[^1], UMD users may need additional adaptation.
     *
     * [^1]: [support for React 19] https://github.com/dream-num/univer/pull/4247
     */

    /**
     * Fix `Uncaught TypeError: client.createRoot is not a function`
     * If using UMD React < 18, you might need the following code.
     */
    (function (global) {
      'use strict';
      if (!global.ReactDOM) {
        throw new Error('ReactDOM must be loaded before ReactCreateRoot.');
      }
      const ReactDOM = global.ReactDOM;
      if (!ReactDOM.createRoot) {
        ReactDOM.createRoot = function (container) {
          return {
            render: (element) => {
              ReactDOM.render(element, container);
            },
          };
        };
      }
    })(this);

    /**
     * Fix `Uncaught TypeError: jsxRuntime.jsx is not a function`
     * If using UMD React, you might need the following code.
     * Reference: https://unpkg.com/react@18.3.1/cjs/react-jsx-runtime.production.min.js
     */
    (function (global) {
      'use strict';
      if (!global.React) {
        throw new Error('React must be loaded before ReactJSXRuntime.');
      }
      const React = global.React;
      if (!React.jsx || !React.jsxs) {
        const REACT_ELEMENT_TYPE = Symbol.for('react.element');
        const hasOwnProperty = Object.prototype.hasOwnProperty;
        const RESERVED_PROPS = {
          key: true,
          ref: true,
          __self: true,
          __source: true,
        };
        const ReactCurrentOwner = React.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner;
        function createReactElement(type, config, maybeKey) {
          const props = {};
          let key = null;
          let ref = null;
          if (maybeKey !== undefined) {
            key = `${maybeKey}`;
          }
          if (config.key !== undefined) {
            key = `${config.key}`;
          }
          if (config.ref !== undefined) {
            ref = config.ref;
          }
          for (var propName in config) {
            if (hasOwnProperty.call(config, propName) && !RESERVED_PROPS.hasOwnProperty(propName)) {
              props[propName] = config[propName];
            }
          }
          if (type && type.defaultProps) {
            const defaultProps = type.defaultProps;
            for (var propName in defaultProps) {
              if (props[propName] === undefined) {
                props[propName] = defaultProps[propName];
              }
            }
          }
          return {
            $$typeof: REACT_ELEMENT_TYPE,
            type,
            key,
            ref,
            props,
            _owner: ReactCurrentOwner.current,
          };
        }
        React.jsx = createReactElement;
        React.jsxs = createReactElement;
      }
    })(this);
  </script>

  <script src="https://unpkg.com/@univerjs/protocol/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/core/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/telemetry/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/rpc/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/design/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/engine-render/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/engine-numfmt/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/engine-formula/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/drawing/lib/umd/index.js"></script>

  <script src="https://unpkg.com/@univerjs/core/lib/umd/facade.js"></script>
  <script src="https://unpkg.com/@univerjs/ui/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/docs/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/docs-ui/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-ui/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-formula/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-formula-ui/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-numfmt/lib/umd/index.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-numfmt-ui/lib/umd/index.js"></script>

  <script src="https://unpkg.com/@univerjs/engine-formula/lib/umd/facade.js"></script>
  <script src="https://unpkg.com/@univerjs/ui/lib/umd/facade.js"></script>
  <script src="https://unpkg.com/@univerjs/docs-ui/lib/umd/facade.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets/lib/umd/facade.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-ui/lib/umd/facade.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-formula/lib/umd/facade.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-numfmt/lib/umd/facade.js"></script>

  <script src="https://unpkg.com/@univerjs/design/lib/umd/locale/zh-CN.js"></script>
  <script src="https://unpkg.com/@univerjs/ui/lib/umd/locale/zh-CN.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets/lib/umd/locale/zh-CN.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-ui/lib/umd/locale/zh-CN.js"></script>
  <script src="https://unpkg.com/@univerjs/docs-ui/lib/umd/locale/zh-CN.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-formula-ui/lib/umd/locale/zh-CN.js"></script>
  <script src="https://unpkg.com/@univerjs/sheets-numfmt-ui/lib/umd/locale/zh-CN.js"></script>

  <link rel="stylesheet" href="https://unpkg.com/@univerjs/design/lib/index.css" />
  <link rel="stylesheet" href="https://unpkg.com/@univerjs/ui/lib/index.css" />
  <link rel="stylesheet" href="https://unpkg.com/@univerjs/docs-ui/lib/index.css" />
  <link rel="stylesheet" href="https://unpkg.com/@univerjs/sheets-ui/lib/index.css" />
  <link rel="stylesheet" href="https://unpkg.com/@univerjs/sheets-formula-ui/lib/index.css" />
  <link rel="stylesheet" href="https://unpkg.com/@univerjs/sheets-numfmt-ui/lib/index.css" />

  <style>
    html,
    body,
    #root,
    #app {
      padding: 0;
      margin: 0;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="app"></div>
 
  <script>
    const { Univer, LocaleType, merge, UniverInstanceType } = UniverCore
    const { FUniver } = UniverCoreFacade
    const { defaultTheme } = UniverDesign
    const { UniverRenderEnginePlugin } = UniverEngineRender
    const { UniverFormulaEnginePlugin } = UniverEngineFormula
    const { UniverUIPlugin } = UniverUi
    const { UniverSheetsPlugin } = UniverSheets
    const { UniverSheetsUIPlugin } = UniverSheetsUi
    const { UniverDocsPlugin } = UniverDocs
    const { UniverDocsUIPlugin } = UniverDocsUi
    const { UniverSheetsFormulaPlugin } = UniverSheetsFormula
    const { UniverSheetsFormulaUIPlugin } = UniverSheetsFormulaUi
    const { UniverSheetsNumfmtPlugin } = UniverSheetsNumfmt
    const { UniverSheetsNumfmtUIPlugin } = UniverSheetsNumfmtUi

    const univer = new Univer({
      theme: defaultTheme,
      locale: LocaleType.ZH_CN,
      locales: {
        [LocaleType.ZH_CN]: merge(
          {},
          UniverDesignZhCN,
          UniverUiZhCN,
          UniverSheetsZhCN,
          UniverSheetsUiZhCN,
          UniverDocsUiZhCN,
          UniverSheetsFormulaUiZhCN,
          UniverSheetsNumfmtUiZhCN
        ),
      },
    });

    univer.registerPlugin(UniverRenderEnginePlugin);
    univer.registerPlugin(UniverFormulaEnginePlugin);

    univer.registerPlugin(UniverUIPlugin, {
      container: 'app',
    });

    univer.registerPlugin(UniverSheetsPlugin);
    univer.registerPlugin(UniverSheetsUIPlugin);

    univer.registerPlugin(UniverDocsPlugin);
    univer.registerPlugin(UniverDocsUIPlugin);

    univer.registerPlugin(UniverSheetsFormulaPlugin);
    univer.registerPlugin(UniverSheetsFormulaUIPlugin);
    univer.registerPlugin(UniverSheetsNumfmtPlugin);
    univer.registerPlugin(UniverSheetsNumfmtUIPlugin);

    univer.createUnit(UniverInstanceType.UNIVER_SHEET, {});

    const univerAPI = FUniver.newAPI(univer);
  </script>
</body>
```

## è¡¨æ ¼åŸºæœ¬æ“ä½œ

åœ¨ä¸Šä¸€å°èŠ‚çš„ä»£ç ä¸­ï¼Œä½ å·²ç»åˆ›å»ºäº†ä¸€ä¸ª Univer å®ä¾‹å¹¶åˆ›å»ºäº†ä¸€ä¸ªç©ºçš„ç”µå­è¡¨æ ¼ï¼Œä¸è¿‡å¤§éƒ¨åˆ†æƒ…å†µä¸‹ä½ å¯èƒ½éœ€è¦çš„æ˜¯åœ¨ Univer å½“ä¸­åŠ è½½å·²æœ‰æ•°æ®ã€‚è¿™ä¸€å°èŠ‚å°†ä¼šä»‹ç»å¦‚ä½•å‘ Univer åŠ è½½æ•°æ®ã€ä¿®æ”¹æ•°æ®ä»¥åŠå¦‚ä½•ä» Univer ä¸­å­˜å‚¨æ•°æ®ã€‚

### åŠ è½½æ•°æ®

é€šè¿‡è°ƒç”¨ `univerAPI` çš„ `createUniverSheet` æ–¹æ³•ï¼Œå¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ `Workbook` å®ä¾‹ã€‚æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº† `Workbook` çš„æ•°æ®ï¼Œåº”è¯¥ç¬¦åˆ `IWorkbookData` æ¥å£ã€‚

```typescript
import { IWorkbookData, LocaleType } from "@univerjs/core";

const data: IWorkbookData = {
  id: 'test',
  sheets: {
    sheet1: {
      id: 'sheet1',
      name: 'sheet1',
      cellData: {
        0: {
          0: {
            v: 'Hello Univer!',
          },
        },

      },
      rowCount: 100,
      columnCount: 100,
    },
  },
  locale: LocaleType.ZH_CN,
  name: 'Test Workbook',
  sheetOrder: ['sheet1'],
};
const workbook = univerAPI.createWorkbook(data);
```

ä½ å¯ä»¥åœ¨ [å·¥ä½œè¡¨æ•°æ®ç»“æ„](/guides/sheets/getting-started/workbook-data) è¿›ä¸€æ­¥äº†è§£å¦‚ä½•åˆå§‹åŒ–è¡¨æ ¼æ•°æ®ã€‚

### ä¿®æ”¹æ•°æ®

ä½ å¯ä»¥é€šè¿‡è°ƒç”¨ `univerAPI` çš„æ–¹æ³•æ¥ä½¿ç”¨ Univer äº†ï¼Œä¾‹å¦‚è·å–å½“å‰æ¿€æ´»çš„ï¼Œå¹¶åœ¨æŒ‡å®šçš„èŒƒå›´æ›´æ–°å€¼ï¼š

```typescript
const sheet = univerAPI.getActiveWorkbook().getActiveSheet();

const range = sheet.getRange('A1');
range.setValue(1);
```

<Callout type="error" emoji="ğŸš¨">
  Univer åŸºäº [å‘½ä»¤ç³»ç»Ÿ](/zh-CN/introduction/architecture/univer#command-system) å¯¹çŠ¶æ€å’Œæ•°æ®è¿›è¡Œæ“ä½œå’Œæ›´æ–°ï¼Œå› æ­¤ä½ **å¿…é¡»**ä½¿ç”¨ Facade APIï¼ˆæˆ–å…¶å¯¹åº”çš„å‘½ä»¤ï¼‰æ¥æ›´æ–°æ•°æ®ï¼Œä»»ä½•ç›´æ¥å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ä»¥æ›´æ–°è§†å›¾çš„æ“ä½œéƒ½ä¸ä¼šç”Ÿæ•ˆã€‚
</Callout>

### å­˜å‚¨æ•°æ®

é€šè¿‡è°ƒç”¨ `workbook` çš„ `save` æ–¹æ³•ï¼Œå¯ä»¥å¾—åˆ° `IWorkbookData` å¯¹è±¡ï¼ŒåŒ…å«è¡¨æ ¼å†…éƒ¨çš„æœ€æ–°æ•°æ®ã€‚

```typescript
const savedData = univerAPI.getActiveWorkbook().save();
```

## ä¸‹ä¸€æ­¥

* åœ¨ [åŸºç¡€æ¦‚å¿µ](/introduction/concepts) ç« èŠ‚äº†è§£æœ¬ç« ä¸­å‡ºç°çš„æ’ä»¶ã€å‘½ä»¤å’Œ Facade API ç­‰æ¦‚å¿µã€‚
* åœ¨ [å·¥ä½œè¡¨æ•°æ®ç»“æ„](/guides/sheets/getting-started/workbook-data) è¿›ä¸€æ­¥äº†è§£å¦‚ä½•åˆå§‹åŒ–è¡¨æ ¼æ•°æ®ã€‚
* åœ¨ [åŠŸèƒ½](/guides/sheets/features/core) ç›¸å…³ç« èŠ‚ä¸­äº†è§£ä¿®æ”¹ç”µå­è¡¨æ ¼æ•°æ®çš„æ‰€æœ‰æ“ä½œã€‚

[^1]: https://blog.npmjs.org/post/110924823920/npm-weekly-5
[^2]: https://pnpm.io/npmrc#auto-install-peers
[^3]: https://github.com/yarnpkg/yarn/issues/1503
