import { Tabs } from 'nextra/components'
import { Callout } from 'nextra/components'
import FeatureMeta from '@/components/feature-meta'
import VersionBadge from '@/components/version-badge'

# æ•°å­—æ ¼å¼

<FeatureMeta texts={['âœ…', '-', '-', 'âœ…', 'UniverSheetsCorePreset' ]} />

æ•°å­—æ ¼å¼æ’ä»¶æä¾›äº†å¯¹å•å…ƒæ ¼ä¸­æ•°å­—çš„æ ¼å¼åŒ–åŠŸèƒ½ï¼ŒåŒ…æ‹¬æ•°å­—çš„å°æ•°ä½æ•°ã€åƒåˆ†ä½åˆ†éš”ç¬¦ã€è´§å¸ç¬¦å·ç­‰ã€‚

<Callout type="warning" emoji="ğŸš¨">
  ä¸æ”¯æŒ **DBNum** è¯­æ³•
</Callout>

## ä½¿ç”¨æ–¹æ³•

UI ç•Œé¢ä¸­ï¼Œå¯ä»¥é€šè¿‡èœå•æ è®¾ç½®å•å…ƒæ ¼çš„æ•°å­—æ ¼å¼ã€‚æˆ–è€…åœ¨å•å…ƒæ ¼æ•°æ® [`ICellData`](/zh-CN/guides/sheets/getting-started/cell-data) å¯¹è±¡ä¸­è®¾ç½® [`s.n.pattern`](/zh-CN/guides/sheets/getting-started/cell-data#number-format) å­—æ®µã€‚

```typescript
{
  v: 123456.789,
  s: {
    n: {
      pattern: '#,##0.00'
    }
  }
}
```

## Facade API <VersionBadge version="0.5.2+" />

### è®¾ç½®æ•°å­—æ ¼å¼ 

å…·ä½“å‚æ•°è¯·å‚è€ƒ https://support.microsoft.com/zh-cn/office/%E6%95%B0%E5%AD%97%E6%A0%BC%E5%BC%8F%E4%BB%A3%E7%A0%81-5026bbd6-04bc-48cd-bf33-80f18b4eae68

```typescript
const fWorkbook = univerAPI.getActiveWorkbook();
const fWorksheet = fWorkbook.getActiveSheet();

// å°† A1 å•å…ƒæ ¼çš„æ•°å­—æ ¼å¼è®¾ç½®ä¸º '#,##0.00'
const fRange = fWorksheet.getRange('A1');
fRange.setValue(1234.567).setNumberFormat('#,##0.00');
console.log(fRange.getDisplayValue()); // 1,234.57
```

```typescript
const fWorkbook = univerAPI.getActiveWorkbook();
const fWorksheet = fWorkbook.getActiveSheet();

// è®¾ç½® A1:B2 èŒƒå›´çš„æ•°å­—æ ¼å¼
const fRange = fWorksheet.getRange('A1:B2');
fRange.setValues([
  [1234.567, 0.1234],
  [45658, 0.9876]
]).setNumberFormats([
  ['#,##0.00', '0.00%'],
  ['yyyy-MM-DD', '']
]);
console.log(fRange.getDisplayValues()); // [['1,234.57', '12.34%'], ['2025-01-01', 0.9876]]
```

### è·å–æ•°å­—æ ¼å¼

```typescript
const fWorkbook = univerAPI.getActiveWorkbook();
const fWorksheet = fWorkbook.getActiveSheet();

// è·å– A1:B2 èŒƒå›´å·¦ä¸Šè§’å•å…ƒæ ¼çš„æ•°å­—æ ¼å¼
const fRange = fWorksheet.getRange('A1:B2');
console.log(fRange.getNumberFormat());
```

```typescript
const fWorkbook = univerAPI.getActiveWorkbook();
const fWorksheet = fWorkbook.getActiveSheet();

// è·å– A1:B2 èŒƒå›´çš„æ•°å­—æ ¼å¼
const fRange = fWorksheet.getRange('A1:B2');
console.log(fRange.getNumberFormats());
```

### è®¾ç½®æ•°å­—æ ¼å¼çš„åŒºåŸŸè®¾ç½®

ä½¿ç”¨ [`FWorkbook.setNumfmtLocal(local)`](https://reference.univer.ai/zh-CN/classes/FWorkbook#setnumfmtlocal) æ–¹æ³•è®¾ç½®æ•°å­—æ ¼å¼çš„åŒºåŸŸè®¾ç½®ã€‚

```typescript
const fWorkbook = univerAPI.getActiveWorkbook();
const fWorksheet = fWorkbook.getActiveSheet();
const fRange = fWorksheet.getRange('A1');
fRange.setValue(1234.567).setNumberFormat('#,##0.00');

// è®¾ç½®æ•°å­—æ ¼å¼çš„åŒºåŸŸè®¾ç½®ä¸º en_US
fWorkbook.setNumfmtLocal('en_US');
console.log(fRange.getDisplayValue()); // 1,234.57

// è®¾ç½®æ•°å­—æ ¼å¼çš„åŒºåŸŸè®¾ç½®ä¸º de_DE
fWorkbook.setNumfmtLocal('de_DE');
console.log(fRange.getDisplayValue()); // 1.234,57
```

## å¸¸è§é—®é¢˜

### å…³äºå•å…ƒæ ¼è¾“å…¥å¸¦æœ‰0å¼€å¤´æˆ–å¯è½¬æ¢ä¸ºæ—¥æœŸæ ¼å¼çš„æ•°å­—æ—¶ï¼Œä¸æƒ³è¢«é»˜è®¤è½¬æ¢ [#qa-1]

å¯å°†å•å…ƒæ ¼æ•°å­—æ ¼å¼è®¾ç½®ä¸ºæ–‡æœ¬æ ¼å¼ï¼Œæˆ–åœ¨è¾“å…¥æ•°å­—å‰åŠ ä¸Šå•å¼•å· `'`ï¼ˆ[å¼ºåˆ¶æ–‡æœ¬](/zh-CN/guides/sheets/getting-started/cell-data#cell-type)ï¼‰ã€‚

`ICellData` å¯¹è±¡ä¸­è®¾ç½® `s.n.pattern`ï¼š

```typescript
import { DEFAULT_TEXT_FORMAT_EXCEL } from '@univerjs/engine-numfmt';
 
{
  v: '012.0',
  s: {
    n: {
      pattern: DEFAULT_TEXT_FORMAT_EXCEL // æ–‡æœ¬æ ¼å¼
    }
  }
}
```

`univerAPI` è®¾ç½®å•å…ƒæ ¼æ ¼å¼ï¼š

```typescript
range.setNumberFormat(DEFAULT_TEXT_FORMAT_EXCEL);
```

## ç¦ç”¨å•å…ƒæ ¼æ–‡æœ¬æ ¼å¼è­¦å‘Šå’Œæ ‡è®° <VersionBadge version="0.6.7+" />

`UniverSheetsNumfmtPlugin` æ’ä»¶æä¾›äº† `disableTextFormatAlert` å’Œ `disableTextFormatMark` ä¸¤ä¸ªé…ç½®é¡¹ï¼Œç”¨äºç¦ç”¨å•å…ƒæ ¼æ–‡æœ¬æ ¼å¼çš„è­¦å‘Šå’Œæ ‡è®°ã€‚

```typescript
// presets é…ç½®
const { univerAPI } = createUniver({
  // ...
  presets: [
    UniverSheetsCorePreset({
      disableTextFormatAlert: true,
      disableTextFormatMark: true
    }),
  ]
});
```

```typescript
// Plugin é…ç½®
univer.registerPlugin(UniverSheetsNumfmtPlugin, {
  disableTextFormatAlert: true,
  disableTextFormatMark: true,
});
```
