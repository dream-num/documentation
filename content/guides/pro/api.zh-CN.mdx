---
title: API
---

## 创建文档

<APITable
  request={{
    method: 'POST',
    url: '/universer-api/snapshot/{type}/unit/-/create',
    headers: <code>content-type: application/json</code>,
    parametersType: 'Body',
    parameters: [{
      name: 'type',
      type: 'enum(int)',
      required: true,
      description: '1（docs），2（sheets）路径和请求体参数',
    }, {
      name: 'name',
      type: 'string',
      required: true,
      description: '文档名称',
    }, {
      name: 'creator',
      type: 'string',
      required: true,
      description: '创建者 id',
    }],
    example: `curl http://localhost:8000/universer-api/snapshot/{type}/unit/-/create \\
    -X POST \\
    -H 'Content-Type: application/json' \\
    --data-raw '{"type":2,"name":"New Sheet By Univer","creator":"userID"}'`,
  }}
  response={{
    type: 'application/json',
    parameters: [{
      name: 'error',
      type: 'object',
      properties: [{
        name: 'code',
        type: 'enum(int)',
        description: '1（成功）',
      }, {
        name: 'message',
        type: 'string',
        description: '失败信息',
      }],
    }, {
      name: 'unitID',
      type: 'string',
      description: '文档 id',
    }],
    example: JSON.stringify({
      error: {
        code: 1,
        message: 'success',
      },
      unitID: 'ETVf-B4lQqOSE_p09mcp9Q',
    }, null, 2),
  }}
/>

## 获取文档列表

<APITable
  request={{
    method: 'GET',
    url: '/universer-api/snapshot/{type}/units',
    parametersType: 'Query',
    parameters: [{
      name: 'type',
      type: 'enum(int)',
      required: true,
      description: '1（doc），2（sheet）路径和请求体参数',
    }, {
      name: 'nextCursor',
      type: 'string',
      required: false,
      description: '分页的下一页游标',
    }],
    example: `curl -X GET 'http://localhost:8000/universer-api/snapshot/1/units?nextCursor=100'`,
  }}
  response={{
    type: 'application/json',
    parameters: [{
      name: 'error',
      type: 'object',
      properties: [{
        name: 'code',
        type: 'enum(int)',
        description: '1（成功）',
      }, {
        name: 'message',
        type: 'string',
        description: '失败信息',
      }],
    }, {
      name: 'units',
      type: 'array[object]',
      description: '文档列表',
      properties: [{
        name: 'unitID',
        type: 'string',
        description: '文档 id',
      }, {
        name: 'name',
        type: 'string',
        description: '文档名称',
      }, {
        name: 'type',
        type: 'enum(int)',
        description: '1（doc），2（sheet）',
      }],
    }, {
      name: 'nextCursor',
      type: 'string',
      description: '分页的下一页游标，当为空时表示为最后一页',
    }],
    example: JSON.stringify({
      error: {
        code: 1,
        message: '',
      },
      units: [{
        unitID: '1',
        name: 'a',
        type: 1,
      }],
      nextCursor: '200',
    }, null, 2),
  }}
/>

## 删除文档

<APITable
  request={{
    method: 'DELETE',
    url: '/universer-api/snapshot/-/units',
    headers: <code>content-type: application/json</code>,
    parametersType: 'Query',
    parameters: [{
      name: 'unitIds',
      type: 'array[string]',
      required: true,
      description: '文档 id 数组',
    }],
    example: `curl -X DELETE 'http://localhost:8000/universer-api/snapshot/-/units?unitIds=1&unitIds=2'`,
  }}
  response={{
    type: 'application/json',
    parameters: [{
      name: 'error',
      type: 'object',
      properties: [{
        name: 'code',
        type: 'enum(int)',
        description: '1（成功）',
      }, {
        name: 'message',
        type: 'string',
        description: '失败信息',
      }],
    }],
    example: JSON.stringify({
      error: {
        code: 1,
        message: '',
      },
    }, null, 2),
  }}
/>

## 上传文件

<APITable
  request={{
    method: 'POST',
    url: '/universer-api/stream/file/upload',
    headers: <code>content-type: multipart/form-data</code>,
    parametersType: 'Body',
    parameters: [{
      name: 'size',
      type: 'int',
      required: true,
      description: '文件大小（byte），query 参数；参数必须等于真实文件大小，如果不等于会造成返回 error',
    }, {
      name: 'file',
      type: 'Form.file',
      required: true,
      description: 'HTML form 上传文件',
    }],
    example: `curl 'http://localhost:8000/universer-api/stream/file/upload?size=125466' \\
    --header 'cookie: _univer=XXXXXX' \\
    --form 'file=@"demo.xlsx"'`,
  }}
  response={{
    type: 'application/json',
    parameters: [{
      name: 'FileId',
      type: 'string',
      description: '文件 id，用于后面请求比如导入和导出',
    }],
    example: JSON.stringify({
      FileId: 'xxxx',
    }, null, 2),
  }}
/>

## 导入

<APITable
  request={{
    method: 'POST',
    url: '/universer-api/exchange/{type}/import',
    headers: <code>content-type: application/json</code>,
    parametersType: 'Body',
    parameters: [{
      name: 'type',
      type: 'enum(int)',
      required: true,
      description: '1（doc），2（sheet）',
    }, {
      name: 'outputType',
      type: 'enum(int)',
      required: true,
      description: '1（unit），2（json）',
    }, {
      name: 'fileID',
      type: 'string',
      required: true,
      description: '上传的文件 id',
    }, {
      name: 'minSheetRowCount',
      type: 'int',
      required: true,
      description: '最小行数，导入时会检查表格行数是否满足要求',
    }, {
      name: 'minSheetColumnCount',
      type: 'int',
      required: true,
      description: '最小列数，导入时会检查表格列数是否满足要求',
    }],
    example: `curl -X POST 'http://localhost:8000/universer-api/exchange/2/import' \\
    -H 'Content-Type: application/json' \\
    --data-raw '{"fileID":"123","outputType":1,"minSheetRowCount":1000,"minSheetColumnCount":20}'`,
  }}
  response={{
    type: 'application/json',
    parameters: [{
      name: 'error',
      type: 'object',
      properties: [{
        name: 'code',
        type: 'enum(int)',
        description: '1（成功）',
      }, {
        name: 'message',
        type: 'string',
        description: '失败信息',
      }],
    }, {
      name: 'taskID',
      type: 'string',
      description: '转换任务 id，导入导出是异步的，使用该 id 轮询接口获取转换结果',
    }],
    example: JSON.stringify({
      error: {
        code: 1,
        message: '',
      },
      taskID: '456',
    }, null, 2),
  }}
/>

## 导出

<APITable
  request={{
    method: 'POST',
    url: '/universer-api/exchange/{type}/export',
    headers: <code>content-type: application/json</code>,
    parametersType: 'Body',
    parameters: [{
      name: 'type',
      type: 'enum(int)',
      required: true,
      description: '1（doc），2（sheet）',
    }, {
      name: 'unitID',
      type: 'string',
      required: true,
      description: '文档 id',
    }, {
      name: 'sscSwitch',
      type: 'boolean',
      required: false,
      description: '是否开启 SSC（Server Side Calculation），设置为 true 则触发服务端公式计算，默认为 false',
    }],
    example: `curl -X POST 'http://localhost:8000/universer-api/exchange/2/export' \\
    -H 'Content-Type: application/json' \\
    --data-raw '{"unitID":"xxxx","type":2}'`,
  }}
  response={{
    type: 'application/json',
    parameters: [{
      name: 'error',
      type: 'object',
      properties: [{
        name: 'code',
        type: 'enum(int)',
        description: '1（成功）',
      }, {
        name: 'message',
        type: 'string',
        description: '失败信息',
      }],
    }, {
      name: 'taskID',
      type: 'string',
      description: '转换任务 id，导入导出是异步的，使用该 id 轮询接口获取转换结果',
    }],
    example: JSON.stringify({
      error: {
        code: 1,
        message: '',
      },
      taskID: '456',
    }, null, 2),
  }}
/>

## 获取转换结果

<APITable
  request={{
    method: 'GET',
    url: '/universer-api/exchange/task/{taskID}',
    parametersType: 'Path',
    parameters: [{
      name: 'taskID',
      type: 'string',
      required: true,
      description: '转换任务 id',
    }],
    example: `curl -X GET 'http://localhost:8000/universer-api/exchange/task/123'`,
  }}
  response={{
    type: 'application/json',
    parameters: [{
      name: 'error',
      type: 'object',
      properties: [{
        name: 'code',
        type: 'enum(int)',
        description: '1（成功）',
      }, {
        name: 'message',
        type: 'string',
        description: '失败信息',
      }],
    }, {
      name: 'status',
      type: 'enum(string)',
      description: '"pending", "done", "failed"',
    }, {
      name: 'export',
      type: 'object',
      properties: [{
        name: 'fileID',
        type: 'string',
        description: '导出转换结果的文件 id，用于后面接口获取文件内容',
      }],
    }, {
      name: 'import',
      type: 'object',
      properties: [{
        name: 'unitID',
        type: 'string',
        description: '导入转换后的 unitID，用于打开在线表格',
      }, {
        name: 'jsonID',
        type: 'string',
        description: '导入转换为 JSON 结果的文件 id，用于后面接口获取文件内容',
      }],
    }],
    example: JSON.stringify({
      error: {
        code: 1,
        message: '',
      },
      status: 'done',
      export: {
        fileID: '456',
      },
      import: {
        unitID: '789',
        jsonID: '012',
      },
    }, null, 2),
  }}
/>

## 获取文件

<APITable
  request={{
    method: 'GET',
    url: '/universer-api/file/{fileID}/sign-url',
    parametersType: 'Path',
    parameters: [{
      name: 'fileID',
      type: 'string',
      required: true,
      description: '转换任务的结果文件 id',
    }],
    example: `curl -X GET 'http://localhost:8000/universer-api/file/1234/sign-url'`,
  }}
  response={{
    type: 'application/json',
    parameters: [{
      name: 'error',
      type: 'object',
      properties: [{
        name: 'code',
        type: 'enum(int)',
        description: '1（成功）',
      }, {
        name: 'message',
        type: 'string',
        description: '失败信息',
      }],
    }, {
      name: 'url',
      type: 'string',
      description: '文件的下载连接',
    }],
    example: JSON.stringify({
      error: {
        code: 1,
        message: '',
      },
      url: 'https://example.com/path/to/file.xlsx',
    }, null, 2),
  }}
/>
