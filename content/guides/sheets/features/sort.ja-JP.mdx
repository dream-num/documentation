---
title: 並べ替え
icon: ArrowUpNarrowWide
---

<MetaData
  lang="ja-JP"
  meta={{
    preset: [{
      client: '@univerjs/preset-sheets-sort',
      locale: '@univerjs/preset-sheets-sort/locales/zh-CN',
      style: '@univerjs/preset-sheets-sort/lib/index.css',
    }],
    plugins: [{
      client: '@univerjs/sheets-sort',
      facade: '@univerjs/sheets-sort/facade',
    }, {
      client: '@univerjs/sheets-sort-ui',
      locale: '@univerjs/sheets-sort-ui/locale/zh-CN',
      style: '@univerjs/sheets-sort-ui/lib/index.css',
    }],
    server: 'No',
  }}
/>

並べ替え機能は、スプレッドシート内のデータを並び替えて、情報の整理や分析を容易にします。昇順、降順、カスタムソートなどの複数の並べ替え方法をサポートしており、ユーザーが必要なデータを素早く見つけられるよう支援します。

## プリセットモード

### インストール

```package-install
npm install @univerjs/preset-sheets-sort
```

### 使い方

```typescript
import { UniverSheetsCorePreset } from '@univerjs/preset-sheets-core'
import UniverPresetSheetsCoreEnUS from '@univerjs/preset-sheets-core/locales/en-US'
import { UniverSheetsSortPreset } from '@univerjs/preset-sheets-sort' // [!code ++]
import UniverPresetSheetsSortEnUS from '@univerjs/preset-sheets-sort/locales/en-US' // [!code ++]
import { createUniver, LocaleType, mergeLocales } from '@univerjs/presets'

import '@univerjs/preset-sheets-core/lib/index.css'
import '@univerjs/preset-sheets-sort/lib/index.css' // [!code ++]

const { univerAPI } = createUniver({
  locale: LocaleType.En_US,
  locales: {
    [LocaleType.En_US]: mergeLocales(
      UniverPresetSheetsCoreEnUS,
      UniverPresetSheetsSortEnUS, // [!code ++]
    ),
  },
  presets: [
    UniverSheetsCorePreset(),
    UniverSheetsSortPreset(), // [!code ++]
  ],
})
```

{/* ### プリセットと設定 */}

## プラグインモード

### インストール

```package-install
npm install @univerjs/sheets-sort @univerjs/sheets-sort-ui
```

### 使い方

```typescript
import { LocaleType, mergeLocales, Univer } from '@univerjs/core'
import { UniverSheetsSortPlugin } from '@univerjs/sheets-sort' // [!code ++]
import { UniverSheetsSortUIPlugin } from '@univerjs/sheets-sort-ui' // [!code ++]
import SheetsSortUIEnUS from '@univerjs/sheets-sort-ui/locale/en-US' // [!code ++]

import '@univerjs/sheets-sort-ui/lib/index.css' // [!code ++]

import '@univerjs/sheets-sort/facade' // [!code ++]

const univer = new Univer({
  locale: LocaleType.En_US,
  locales: {
    [LocaleType.En_US]: mergeLocales(
      SheetsSortUIEnUS, // [!code ++]
    ),
  },
})

univer.registerPlugin(UniverSheetsSortPlugin) // [!code ++]
univer.registerPlugin(UniverSheetsSortUIPlugin) // [!code ++]
```

{/* ### プラグインと設定 */}

## Facade API

Facade API の完全な型定義は、[FacadeAPI](https://reference.univer.ai/ja-JP) を参照してください。

### ワークシートの並べ替え

[`FWorksheet.sort(colIndex, asc)`](https://reference.univer.ai/ja-JP/classes/FWorksheet#sort) メソッドは、指定した列でワークシートを並べ替えるために使用できます。

```typescript
const fWorkbook = univerAPI.getActiveWorkbook()
const fWorksheet = fWorkbook.getActiveSheet()

// ワークシートを第一列の昇順で並べ替え
fWorksheet.sort(0)

// ワークシートを第一列の降順で並べ替え
fWorksheet.sort(0, false)
```

### 範囲の並べ替え

[`FRange.sort(column)`](https://reference.univer.ai/ja-JP/classes/FRange#sort) メソッドは、指定した列と順序に基づいて範囲内のセルを並べ替えるために使用できます。

```typescript
const fWorkbook = univerAPI.getActiveWorkbook()
const fWorksheet = fWorkbook.getActiveSheet()
const fRange = fWorksheet.getRange('D1:G10')

// ワークシートを第一列の昇順で並べ替え
fRange.sort(0)

// ワークシートを第一列の降順で並べ替え
fRange.sort({ column: 0, ascending: false })

// ワークシートを第一列の降順、第二列の昇順で並べ替え
fRange.sort([{ column: 0, ascending: false }, 1])
```

### イベントリスナー

完全なイベント型定義は、[Events](https://reference.univer.ai/ja-JP/classes/FEventName) で確認できます。

`SheetRangeSorted` イベントは、セル範囲の並べ替えが完了したときに発火します。

```typescript
const disposable = univerAPI.addEvent(univerAPI.Event.SheetRangeSorted, (params) => {
  const { workbook, worksheet, range, sortColumn } = params
})

// イベントリスナーを削除するには、`disposable.dispose()` を使用します。
```

`SheetBeforeRangeSort` イベントは、セル範囲を並べ替える前に発火します。

```typescript
const disposable = univerAPI.addEvent(univerAPI.Event.SheetBeforeRangeSort, (params) => {
  const { workbook, worksheet, range, sortColumn } = params

  // ソート操作をキャンセル
  params.cancel = true
})

// イベントリスナーを削除するには、`disposable.dispose()` を使用します。
```
