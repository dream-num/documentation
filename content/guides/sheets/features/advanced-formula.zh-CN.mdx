---
title: 高级公式引擎
icon: '#pro/Sigma'
---

<MetaData
  lang="zh-CN"
  meta={{
    preset: [{
      client: '@univerjs/preset-sheets-advanced',
      locale: '@univerjs/preset-sheets-advanced/locales/zh-CN',
      style: '@univerjs/preset-sheets-advanced/lib/index.css',
    }],
    plugins: [{
      client: '@univerjs-pro/engine-formula',
      facade: '@univerjs-pro/engine-formula/facade',
    }],
    server: '否',
  }}
/>

高级公式引擎优化了原有的公式引擎，提供了更高效的计算性能和更丰富的功能。它支持多种复杂的公式计算，能够处理大规模数据集，并且提供了更好的错误处理和调试功能。

## Preset Mode

高级公式引擎被包含在 `@univerjs/preset-sheets-advanced` 预设中。

### 安装

<Callout>
  @univerjs/preset-sheets-advanced 的 `UniverSheetsAdvancedPreset` 预设在运行时依赖 `UniverSheetsDrawingPreset` 预设，请先安装 @univerjs/preset-sheets-drawing。
</Callout>

```package-install
npm install @univerjs/preset-sheets-drawing @univerjs/preset-sheets-advanced
```

### 使用

```typescript
import { UniverSheetsAdvancedPreset } from '@univerjs/preset-sheets-advanced' // [!code ++]
import UniverPresetSheetsAdvancedZhCN from '@univerjs/preset-sheets-advanced/locales/zh-CN' // [!code ++]
import { UniverSheetsCorePreset } from '@univerjs/preset-sheets-core'
import UniverPresetSheetsCoreZhCN from '@univerjs/preset-sheets-core/locales/zh-CN'
import { UniverSheetsDrawingPreset } from '@univerjs/preset-sheets-drawing' // [!code ++]
import UniverPresetSheetsDrawingZhCN from '@univerjs/preset-sheets-drawing/locales/zh-CN' // [!code ++]
import { createUniver, LocaleType, merge } from '@univerjs/presets'

import '@univerjs/preset-sheets-core/lib/index.css'
import '@univerjs/preset-sheets-drawing/lib/index.css' // [!code ++]
import '@univerjs/preset-sheets-advanced/lib/index.css' // [!code ++]

const { univerAPI } = createUniver({
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: merge(
      {},
      UniverPresetSheetsCoreZhCN,
      UniverPresetSheetsDrawingZhCN, // [!code ++]
      UniverPresetSheetsAdvancedZhCN, // [!code ++]
    ),
  },
  presets: [
    UniverSheetsCorePreset(),
    UniverSheetsDrawingPreset(), // [!code ++]
    UniverSheetsAdvancedPreset(), // [!code ++]
  ],
})
```

如果你拥有 Univer 的商业许可证，请参考[在客户端使用许可证](/zh-CN/guides/pro/license#在预设模式中使用)进行配置。

{/* ### 预设与配置 */}

## 插件模式

### 安装

```package-install
npm install @univerjs-pro/engine-formula
```

### 使用

使用高级公式引擎需要将原有的 `UniverFormulaEnginePlugin` 替换为 `UniverProFormulaEnginePlugin`。

```typescript
import { UniverProFormulaEnginePlugin } from '@univerjs-pro/engine-formula' // [!code ++]
import { UniverFormulaEnginePlugin } from '@univerjs/engine-formula' // [!code --]

univer.registerPlugin(UniverFormulaEnginePlugin) // [!code --]
univer.registerPlugin(UniverProFormulaEnginePlugin) // [!code ++]
```

如果你拥有 Univer 的商业许可证，请参考[在客户端使用许可证](/zh-CN/guides/pro/license#在插件模式中使用)进行配置。

{/* ### 插件与配置 */}
