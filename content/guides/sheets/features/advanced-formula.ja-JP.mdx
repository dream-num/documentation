---
title: 高度な数式エンジン
icon: '#pro/Sigma'
---

<MetaData
  lang="ja-JP"
  isPro
  meta={{
    preset: [{
      client: '@univerjs/preset-sheets-advanced',
      locale: '@univerjs/preset-sheets-advanced/locales/en-US',
      style: '@univerjs/preset-sheets-advanced/lib/index.css',
    }],
    plugins: [{
      client: '@univerjs-pro/engine-formula',
      facade: '@univerjs-pro/engine-formula/facade',
    }],
    server: 'No',
  }}
/>

高度な数式エンジン（Advanced Formula Engine）は、従来の数式エンジンを最適化し、計算性能を向上させ、より豊富な機能を提供します。複雑な数式計算をサポートし、大規模なデータセットを処理できるほか、エラー処理やデバッグ機能も改善されています。

## プリセットモード

高度な数式エンジンは `@univerjs/preset-sheets-advanced` プリセットに含まれています。

### インストール

<Callout>
  `@univerjs/preset-sheets-advanced` の `UniverSheetsAdvancedPreset` は実行時に `UniverSheetsDrawingPreset` に依存します。先に `@univerjs/preset-sheets-drawing` をインストールしてください。
</Callout>

```package-install
npm install @univerjs/preset-sheets-drawing @univerjs/preset-sheets-advanced
```

### 使い方

```typescript
import { UniverSheetsAdvancedPreset } from '@univerjs/preset-sheets-advanced' // [!code ++]
import UniverPresetSheetsAdvancedEnUS from '@univerjs/preset-sheets-advanced/locales/en-US' // [!code ++]
import { UniverSheetsCorePreset } from '@univerjs/preset-sheets-core'
import UniverPresetSheetsCoreEnUS from '@univerjs/preset-sheets-core/locales/en-US'
import { UniverSheetsDrawingPreset } from '@univerjs/preset-sheets-drawing' // [!code ++]
import UniverPresetSheetsDrawingEnUS from '@univerjs/preset-sheets-drawing/locales/en-US' // [!code ++]
import { createUniver, LocaleType, mergeLocales } from '@univerjs/presets'

import '@univerjs/preset-sheets-core/lib/index.css'
import '@univerjs/preset-sheets-drawing/lib/index.css' // [!code ++]
import '@univerjs/preset-sheets-advanced/lib/index.css' // [!code ++]

const { univerAPI } = createUniver({
  locale: LocaleType.En_US,
  locales: {
    [LocaleType.En_US]: mergeLocales(
      UniverPresetSheetsCoreEnUS,
      UniverPresetSheetsDrawingEnUS, // [!code ++]
      UniverPresetSheetsAdvancedEnUS, // [!code ++]
    ),
  },
  presets: [
    UniverSheetsCorePreset(),
    UniverSheetsDrawingPreset(), // [!code ++]
    UniverSheetsAdvancedPreset(), // [!code ++]
  ],
})
```

Univer の商用ライセンスをお持ちの場合、クライアント側での設定方法は [クライアントでのライセンスの使用](/guides/pro/license#in-preset-mode) を参照してください。

{/* ### Presets and Configuration */}

## プラグインモード

### インストール

```package-install
npm install @univerjs-pro/engine-formula
```

### 使い方

高度な数式エンジンを使用する場合は、既存の `UniverFormulaEnginePlugin` を `UniverProFormulaEnginePlugin` に置き換える必要があります。

```typescript
import { UniverProFormulaEnginePlugin } from '@univerjs-pro/engine-formula' // [!code ++]
import { UniverFormulaEnginePlugin } from '@univerjs/engine-formula' // [!code --]

univer.registerPlugin(UniverFormulaEnginePlugin) // [!code --]
univer.registerPlugin(UniverProFormulaEnginePlugin) // [!code ++]
```

Univer の商用ライセンスをお持ちの場合、クライアント側での設定方法は [Using License in Client](/guides/pro/license#in-plugin-mode) を参照してください。

{/* ### Plugins and Configuration */}
