---
title: 排序
icon: ArrowUpNarrowWide
---

<MetaData
  lang="en-US"
  meta={{
    preset: [{
      client: '@univerjs/preset-sheets-sort',
      locale: '@univerjs/preset-sheets-sort/locales/en-US',
      style: '@univerjs/preset-sheets-sort/lib/index.css',
    }],
    plugins: [{
      client: '@univerjs/sheets-sort',
      facade: '@univerjs/sheets-sort/facade',
    }, {
      client: '@univerjs/sheets-sort-ui',
      locale: '@univerjs/sheets-sort-ui/locale/en-US',
      style: '@univerjs/sheets-sort-ui/lib/index.css',
    }],
    server: 'No',
  }}
/>

排序功能允许用户对电子表格中的数据进行排序，以便更好地组织和分析信息。它支持多种排序方式，包括升序、降序和自定义排序，帮助用户快速找到所需数据。

## Preset Mode

### Installation

```package-install
npm install @univerjs/preset-sheets-sort
```

### Usage

```typescript
import { UniverSheetsCorePreset } from '@univerjs/preset-sheets-core'
import UniverPresetSheetsCoreEnUS from '@univerjs/preset-sheets-core/locales/en-US'
import { UniverSheetsSortPreset } from '@univerjs/preset-sheets-sort' // [!code ++]
import UniverPresetSheetsSortEnUS from '@univerjs/preset-sheets-sort/locales/en-US' // [!code ++]
import { createUniver, LocaleType, merge } from '@univerjs/presets'

import '@univerjs/preset-sheets-core/lib/index.css'
import '@univerjs/preset-sheets-sort/lib/index.css' // [!code ++]

const { univerAPI } = createUniver({
  locale: LocaleType.En_US,
  locales: {
    [LocaleType.En_US]: merge(
      {},
      UniverPresetSheetsCoreEnUS,
      UniverPresetSheetsSortEnUS, // [!code ++]
    ),
  },
  presets: [
    UniverSheetsCorePreset(),
    UniverSheetsSortPreset(), // [!code ++]
  ],
})
```

{/* ### Preset and Configuration */}

## Plugin Mode

### Installation

```package-install
npm install @univerjs/sheets-sort @univerjs/sheets-sort-ui
```

### Usage

```typescript
import { LocaleType, merge, Univer } from '@univerjs/core'
import { UniverSheetsSortPlugin } from '@univerjs/sheets-sort' // [!code ++]
import { UniverSheetsSortUIPlugin } from '@univerjs/sheets-sort-ui' // [!code ++]
import SheetsSortUIEnUS from '@univerjs/sheets-sort-ui/locale/en-US' // [!code ++]

import '@univerjs/sheets-sort-ui/lib/index.css' // [!code ++]

import '@univerjs/sheets-sort/facade' // [!code ++]

const univer = new Univer({
  locale: LocaleType.En_US,
  locales: {
    [LocaleType.En_US]: merge(
      {},
      SheetsSortUIEnUS, // [!code ++]
    ),
  },
})

univer.registerPlugin(UniverSheetsSortPlugin) // [!code ++]
univer.registerPlugin(UniverSheetsSortUIPlugin) // [!code ++]
```

{/* ### Plugins and Configuration */}

## Facade API

完整 facade api 类型定义，请查看 [FacadeAPI](https://reference.univer.ai/en-US)

### 工作表排序

[`FWorksheet.sort(colIndex, asc)`](https://reference.univer.ai/en-US/classes/FWorksheet#sort) 方法可以按指定的列对工作表进行排序。

```typescript
const fWorkbook = univerAPI.getActiveWorkbook()
const fWorksheet = fWorkbook.getActiveSheet()

// 按照第一列升序排序工作表
fWorksheet.sort(0)

// 按照第一列降序排序工作表
fWorksheet.sort(0, false)
```

### 区域排序

[`FRange.sort(column)`](https://reference.univer.ai/en-US/classes/FRange#sort) 方法可以按指定的列和顺序对给定范围内的单元格进行排序。

```typescript
const fWorkbook = univerAPI.getActiveWorkbook()
const fWorksheet = fWorkbook.getActiveSheet()
const fRange = fWorksheet.getRange('D1:G10')

// 按照第一列升序排序区域
fRange.sort(0)

// 按照第一列降序排序区域
fRange.sort({ column: 0, ascending: false })

// 按照第一列降序，第二列升序排序区域
fRange.sort([{ column: 0, ascending: false }, 1])
```

### 事件监听

完整事件类型定义，请查看 [Events](https://reference.univer.ai/en-US/classes/FEventName)。

`SheetRangeSorted` 事件在单元格范围排序完成后触发。

```typescript
const callbackDisposable = univerAPI.addEvent(univerAPI.Event.SheetRangeSorted, (params) => {
  const { workbook, worksheet, range, sortColumn } = params
})

// 移除事件监听器，使用 `callbackDisposable.dispose()`
```

`SheetBeforeRangeSort` 事件在单元格范围排序前触发。

```typescript
const callbackDisposable = univerAPI.addEvent(univerAPI.Event.SheetBeforeRangeSort, (params) => {
  const { workbook, worksheet, range, sortColumn } = params

  // 取消排序操作
  params.cancel = true
})

// 移除事件监听器，使用 `callbackDisposable.dispose()`
```
