---
title: ハイパーリンク
icon: Link
---

<MetaData
  lang="ja-JP"
  meta={{
    preset: [{
      client: '@univerjs/preset-sheets-hyper-link',
      locale: '@univerjs/preset-sheets-hyper-link/locales/en-US',
      style: '@univerjs/preset-sheets-hyper-link/lib/index.css',
    }],
    plugins: [{
      client: '@univerjs/sheets-hyper-link',
      facade: '@univerjs/sheets-hyper-link/facade',
    }, {
      client: '@univerjs/sheets-hyper-link-ui',
      facade: '@univerjs/sheets-hyper-link-ui/facade',
      locale: '@univerjs/sheets-hyper-link-ui/locale/en-US',
      style: '@univerjs/sheets-hyper-link-ui/lib/index.css',
    }],
    server: 'No',
  }}
/>

ハイパーリンクは、スプレッドシート内の内部ワークシートやセル、外部のウェブページやメールアドレスなどのコンテンツへ素早く移動・アクセスするために使用されます。

<PlaygroundFrame lang="ja-JP" slug="sheets/hyper-link" clickToShow />

## Preset Mode

### インストール

```package-install
npm install @univerjs/preset-sheets-hyper-link
```

### 使い方

```typescript
import { UniverSheetsCorePreset } from '@univerjs/preset-sheets-core'
import UniverPresetSheetsCoreEnUS from '@univerjs/preset-sheets-core/locales/en-US'
import { UniverSheetsHyperLinkPreset } from '@univerjs/preset-sheets-hyper-link' // [!code ++]
import UniverPresetSheetsHyperLinkEnUS from '@univerjs/preset-sheets-hyper-link/locales/en-US' // [!code ++]
import { createUniver, LocaleType, mergeLocales } from '@univerjs/presets'

import '@univerjs/preset-sheets-core/lib/index.css'
import '@univerjs/preset-sheets-hyper-link/lib/index.css' // [!code ++]

const { univerAPI } = createUniver({
  locale: LocaleType.En_US,
  locales: {
    [LocaleType.En_US]: mergeLocales(
      UniverPresetSheetsCoreEnUS,
      UniverPresetSheetsHyperLinkEnUS, // [!code ++]
    ),
  },
  presets: [
    UniverSheetsCorePreset(),
    UniverSheetsHyperLinkPreset(), // [!code ++]
  ],
})
```

### プリセットと設定

```typescript
UniverSheetsHyperLinkPreset({
  // 外部リンクの開き方をカスタマイズします
  urlHandler: {
    navigateToOtherWebsite: url => window.open(`${url}?utm_source=univer`, '_blank'),
  },
})
```

完全な設定オプションは [`IUniverSheetsHyperLinkPresetConfig`](https://github.com/dream-num/univer-presets/blob/dev/packages/preset-sheets-hyper-link/src/umd.ts#L14) で確認できます。

## Plugin Mode

### インストール

```package-install
npm install @univerjs/sheets-hyper-link @univerjs/sheets-hyper-link-ui
```

### 使い方

```typescript
import { LocaleType, mergeLocales, Univer } from '@univerjs/core'
import { UniverSheetsHyperLinkPlugin } from '@univerjs/sheets-hyper-link' // [!code ++]
import { UniverSheetsHyperLinkUIPlugin } from '@univerjs/sheets-hyper-link-ui' // [!code ++]
import SheetsHyperLinkUIEnUS from '@univerjs/sheets-hyper-link-ui/locale/en-US' // [!code ++]

import '@univerjs/sheets-hyper-link-ui/lib/index.css' // [!code ++]

import '@univerjs/sheets-hyper-link/facade' // [!code ++]
import '@univerjs/sheets-hyper-link-ui/facade' // [!code ++]

const univer = new Univer({
  locale: LocaleType.En_US,
  locales: {
    [LocaleType.En_US]: mergeLocales(
      SheetsHyperLinkUIEnUS, // [!code ++]
    ),
  },
})

univer.registerPlugin(UniverSheetsHyperLinkPlugin) // [!code ++]
univer.registerPlugin(UniverSheetsHyperLinkUIPlugin) // [!code ++]
```

### Plugins and Configuration

```typescript
univer.registerPlugin(UniverSheetsHyperLinkUIPlugin, {
  // 外部リンクの開き方をカスタマイズします
  urlHandler: {
    navigateToOtherWebsite: url => window.open(`${url}?utm_source=univer`, '_blank'),
  },
})
```

完全な設定オプションは [`IUniverSheetsHyperLinkUIConfig`](https://github.com/dream-num/univer/blob/dev/packages/sheets-hyper-link-ui/src/controllers/config.schema.ts#L26) で確認できます。

## Facade API

完全な Facade API の型定義は [FacadeAPI](https://reference.univer.ai/en-US) で確認できます。

### ハイパーリンクの生成・解析・ジャンプ

```typescript
const fWorkbook = univerAPI.getActiveWorkbook()
const sheets = fWorkbook.getSheets()

// 最初のシートのセル F6 へのハイパーリンクを作成します
const sheet1 = sheets[0]
const range = sheet1.getRange('F6')
const hyperlink = range.getUrl()

// ハイパーリンクを解析します
const hyperlinkInfo = fWorkbook.parseSheetHyperlink(hyperlink)

// 2 番目のシートに切り替えます
fWorkbook.setActiveSheet(sheets[1])
fWorkbook.getActiveSheet().getSheetName()

// 3 秒後にハイパーリンクへ移動します
setTimeout(() => {
  fWorkbook.navigateToSheetHyperlink(hyperlink)
  fWorkbook.getActiveSheet().getSheetName()
}, 3000)
```

### セル内ハイパーリンクの操作

```typescript
const fWorkbook = univerAPI.getActiveWorkbook()
const fWorksheet = fWorkbook.getActiveSheet()

// セル A1 に Univer へのハイパーリンクを作成します
const fRange = fWorksheet.getRange('A1')
const richText = univerAPI.newRichText().insertLink('Univer', 'https://univer.ai/')
fRange.setRichTextValueForCell(richText)

// 現在のセル内のハイパーリンクを取得します
const cellValue = fRange.getValue(true)
const hyperlinks = cellValue.getLinks()

// 3 秒後にハイパーリンクを更新します
setTimeout(() => {
  const id = hyperlinks[0].rangeId
  const newUrl = 'https://insight.univer.ai/'
  const newRichText = cellValue.copy().updateLink(id, newUrl)
  fRange.setRichTextValueForCell(newRichText)
}, 3000)

// 6 秒後にハイパーリンクを解除します
setTimeout(() => {
  const newCellValue = fRange.getValue(true)
  const newHyperlinks = newCellValue.getLinks()
  const id = newHyperlinks[0].rangeId
  const newRichText = newCellValue.copy().cancelLink(id)
  fRange.setRichTextValueForCell(newRichText)
}, 6000)
```

### Event Listeners

イベントの型定義は [Events](https://reference.univer.ai/en-US/classes/FEventName) を参照してください。

ハイパーリンクに関するイベントは `univerAPI.addEvent()` で監視できます。

#### リンク追加イベント

`univerAPI.Event.BeforeSheetLinkAdd`: リンク追加の前に発火します

```typescript
const disposable = univerAPI.addEvent(univerAPI.Event.BeforeSheetLinkAdd, (params) => {
  const { workbook, worksheet, row, col, link } = params

  // シートへのリンク追加操作をキャンセルします
  params.cancel = true
})

// Remove the event listener, use `disposable.dispose()`
```

#### リンク更新イベント

`univerAPI.Event.BeforeSheetLinkUpdate`: リンク更新の前に発火します

```typescript
const disposable = univerAPI.addEvent(univerAPI.Event.BeforeSheetLinkUpdate, (params) => {
  const { workbook, worksheet, row, column, id, payload } = params

  // シートのリンク更新操作をキャンセルします
  params.cancel = true
})

// Remove the event listener, use `disposable.dispose()`
```

#### リンク削除イベント

`univerAPI.Event.BeforeSheetLinkCancel`: リンクを解除する前に発火します

```typescript
const disposable = univerAPI.addEvent(univerAPI.Event.BeforeSheetLinkCancel, (params) => {
  const { workbook, worksheet, row, column, id } = params

  // シートのリンク解除操作をキャンセルします
  params.cancel = true
})

// Remove the event listener, use `disposable.dispose()`
```

各イベントは次の共通パラメータを含みます:
- `workbook`: 現在のワークブックインスタンス
- `worksheet`: 現在のワークシートインスタンス
- `row`: リンクを含むセルの行インデックス
- `column`: リンクを含むセルの列インデックス

特殊パラメータ:
- `BeforeSheetLinkAdd` イベントには `link` が含まれます: 追加されるリンク
- `BeforeSheetLinkUpdate` イベントには次が含まれます:
  - `id`: リンク識別子
  - `payload`: 新しいリンクデータ
- `BeforeSheetLinkCancel` イベントには `id` が含まれます: 削除されるリンクの識別子

すべてのイベントコールバックで `params.cancel = true` を設定することで、該当する操作を防止できます。
