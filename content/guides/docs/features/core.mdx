---
title: 核心功能
icon: Cpu
---

<MetaData
  lang="zh-CN"
  meta={{
    preset: [{
      client: '@univerjs/preset-docs-core',
      locale: '@univerjs/preset-docs-core/locales/zh-CN',
      style: '@univerjs/preset-docs-core/lib/index.css',
    }],
    plugins: [{
      client: '@univerjs/core',
    }, {
      client: '@univerjs/engine-formula',
    }, {
      client: '@univerjs/engine-render',
    }, {
      client: '@univerjs/design',
      locale: '@univerjs/design/locales/zh-CN',
      style: '@univerjs/design/lib/index.css',
    }, {
      client: '@univerjs/ui',
      locale: '@univerjs/ui/locales/zh-CN',
      style: '@univerjs/ui/lib/index.css',
    }, {
      client: '@univerjs/docs',
    }, {
      client: '@univerjs/docs-ui',
      locale: '@univerjs/docs-ui/locales/zh-CN',
      style: '@univerjs/docs-ui/lib/index.css',
      facade: '@univerjs/docs-ui/facade',
    }],
    server: '否',
  }}
/>

Univer Docs 的核心功能包含了文档编辑器、公式引擎、渲染引擎、设计系统和 UI 组件库等。它们共同构成了一个强大的文档处理平台，支持多种文档格式和复杂的文档操作。

## 特性

Univer Docs 的核心功能包括：

- **文档渲染**：支持 Univer Docs 的渲染和光标、选区的绘制。
- **文档排版**：支持全文排版，包括段落设置，段前后间距、段落对齐、缩进和悬挂等，也包括段落中的排版能力，标点挤压、标点悬挂、字偶间距、西文断词等。
- **公式计算**：支持 Univer 公式的添加和计算（开发中）。
- **表格能力**：支持插入基本表格和表格的编辑，新增、删除行类操作，编辑单元格等。
- **文档风格**：Univer Docs 不仅支持类似 Microsoft Word 的*传统文档风格*（包含分页、页眉页脚等），也支持类似 Notion 的*现代文档风格*。在现代文档风格中，无需分页，内容可以无限扩展，支持多种官方或第三方块级元素（如文本、图片、表格等）的混合排版（计划中）。
- **页眉页脚**：支持插入页眉页脚和编辑页眉页脚内容，可以区分首页及奇偶页等，仅传统文档支持。
- **列表功能**：支持有序、无序列表和任务列表的插入和编辑，支持列表的缩进和反缩进等。
- **插件系统**：支持插件系统，可以自定义插件，如公式插件、图片插件、图表插件等， 这也是 Univer 核心架构能力之一。

## 预设模式

### 安装

```package-install
npm install @univerjs/presets @univerjs/preset-docs-core
```

### 使用

```typescript
import { UniverDocsCorePreset } from '@univerjs/preset-docs-core'
import UniverPresetDocsCoreZhCN from '@univerjs/preset-docs-core/locales/zh-CN'
import { createUniver, defaultTheme, LocaleType, merge } from '@univerjs/presets'

import '@univerjs/preset-docs-core/lib/index.css'

const { univerAPI } = createUniver({
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: merge(
      {},
      UniverPresetDocsCoreZhCN,
    ),
  },
  theme: defaultTheme,
  presets: [
    UniverDocsCorePreset(),
  ],
})

univerAPI.createUniverDoc({})
```

### 预设与配置

#### @univerjs/presets

**@univerjs/presets** 提供了创建 Univer 应用所需的 `createUniver` 方法，以及暴露了 **@univerjs/core** 和 **@univerjs/design** 的所有方法和对象。

`createUniver` 方法接受一个配置对象，包含主题、语言、预设等选项，返回一个 `Univer` 实例 `univer` 和用于调用 Facade API 的 `FUniver` 实例 `univerAPI`。

参考：[`createUniver`](/zh-CN/reference/methods/create-univer)

#### @univerjs/preset-docs-core

**@univerjs/preset-docs-core** 是 Univer Docs 的核心预设，包含了文档编辑器、公式引擎、渲染引擎等电子文档必要的核心功能。

参考：[`UniverDocsCorePreset`](/zh-CN/reference/packages/presets/univer-docs-core-preset)

## 插件模式

### 安装

```package-install
npm install @univerjs/core @univerjs/engine-render @univerjs/engine-formula @univerjs/design @univerjs/ui @univerjs/docs @univerjs/docs-ui
```

### 使用

```typescript
import { LocaleType, merge, Univer } from '@univerjs/core'
import { defaultTheme } from '@univerjs/design'
import DesignZhCN from '@univerjs/design/locale/zh-CN'
import { UniverDocsPlugin } from '@univerjs/docs'
import { UniverDocsUIPlugin } from '@univerjs/docs-ui'
import DocsUIZhCN from '@univerjs/docs-ui/lib/locale/zh-CN'
import { UniverFormulaEnginePlugin } from '@univerjs/engine-formula'
import { UniverRenderEnginePlugin } from '@univerjs/engine-render'
import { UniverUIPlugin } from '@univerjs/ui'
import UIZhCN from '@univerjs/ui/locale/zh-CN'

import '@univerjs/docs-ui/facade'

import '@univerjs/design/lib/index.css'
import '@univerjs/ui/lib/index.css'
import '@univerjs/docs-ui/lib/index.css'

const univer = new Univer({
  theme: defaultTheme,
  locale: LocaleType.ZH_CN,
  locales: {
    [LocaleType.ZH_CN]: merge(
      {},
      DesignZhCN,
      UIZhCN,
      DocsUIZhCN,
    ),
  },
})

univer.registerPlugin(UniverRenderEnginePlugin)
univer.registerPlugin(UniverFormulaEnginePlugin)
univer.registerPlugin(UniverUIPlugin, {
  container: 'app',
})
univer.registerPlugin(UniverDocsPlugin)
univer.registerPlugin(UniverDocsUIPlugin)

univer.createUnit(UniverInstanceType.UNIVER_DOC, {})
```

### 插件与配置

#### @univerjs/core

**@univerjs/core** 是 Univer 的核心库，提供了创建 Univer 实例、主题、语言等基础功能。

参考：[`Univer`](/zh-CN/reference/classes/univer)

#### @univerjs/engine-render

**@univerjs/engine-render** 是 Univer 的渲染引擎，负责渲染、滚动条、光标和选区等的绘制。其提供了 `UniverRenderEnginePlugin` 插件。

参考：[`UniverRenderEnginePlugin`](/zh-CN/reference/packages/plugins/univer-render-engine-plugin)

#### @univerjs/engine-formula

**@univerjs/engine-formula** 是 Univer 的公式引擎，负责公式的计算和处理。其提供了 `UniverFormulaEnginePlugin` 插件。

参考：[`UniverFormulaEnginePlugin`](/zh-CN/reference/packages/plugins/univer-formula-engine-plugin)

#### @univerjs/design

**@univerjs/design** 是 Univer 的设计系统，提供了所有的基础组件和样式。

详见： [UI 章节](/zh-CN/guides/docs/ui/overview)

#### @univerjs/ui

**@univerjs/ui** 是 Univer 的 UI 基座。其提供了 `UniverUIPlugin` 插件。

参考：[`UniverUIPlugin`](/zh-CN/reference/packages/plugins/univer-ui-plugin)

#### @univerjs/docs

**@univerjs/docs** 是 Univer Docs 的核心插件。其提供了 `UniverDocsPlugin` 插件。

参考：[`UniverDocsPlugin`](/zh-CN/reference/packages/plugins/univer-docs-plugin)

#### @univerjs/docs-ui

**@univerjs/docs-ui** 是 Univer Docs 的 UI 插件，包含了文档编辑器的 UI 组件和交互。其提供了 `UniverDocsUIPlugin` 插件。

参考：[`UniverDocsUIPlugin`](/zh-CN/reference/packages/plugins/univer-docs-ui-plugin)

## Facade API

Univer Docs 提供专业级文档排版能力，相关概念会尽可能与 Microsoft Word 保持一致。

### 操作文档

命令系统中 `unitId` 对应的是文档的唯一标识，文档不存在 `subUnitId`。

文档的文本内容存储在 `body.dataStream` 字符串中，此字符串不包含样式信息。

样式信息单独存储在另外的数据结构中，并通过下标索引与文本内容关联。

对于换行、分页、章节、段落、表格等元素， 在文本内容中使用不同的特殊字符来标记，这些特殊字符在渲染时被转换为对应的元素。

<Callout>
  想要进一步了解文档的数据结构设计吗？推荐阅读[《Univer 文档架构及模块设计》](/zh-CN/blog/univer-doc-architecture) 和[《Univer 文档排版设计初探》](/zh-CN/blog/doc-typesetting-design)。
</Callout>

#### 创建文档

`univer.createUnit` 方法用于创建一个新的文档实例。当第一个参数的值为 `UniverInstanceType.UNIVER_DOC` 时，表示创建一个文档实例。

此时第二个参数是一个可选的 `DocumentDataModel` 对象，包含了文档的初始数据。如果传入 `{}`，则创建一个空文档。

创建成功后返回一个 `DocumentDataModel` 对象，包含了文档的唯一标识 `unitId` 和其他相关信息。

```typescript
// [!code word:data]
univer.createUnit(UniverInstanceType.UNIVER_DOC, data)
```

#### 获取文档 unitId

```typescript
const doc = univerAPI.getActiveDocument()
const unitId = doc?.getId()
```

#### 获取文档数据

```typescript
const doc = univerAPI.getActiveDocument()
const saveData = doc.getSnapshot()
```

#### 销毁文档

当我们不再需要文档时，可以调用 Univer 实例的 `dispose` 方法来销毁实例。

```typescript
univer.dispose()
```

### 操作文本

对富文本区域的文本元素进行操作

#### 插入文本

将指定的文本添加到此文本区域的末尾。

```typescript
const doc = univerAPI.getActiveDocument()
doc?.appendText('Univer')
```

#### 删除文本

删除光标前的字符

```typescript
univerAPI.executeCommand('doc.command.delete-left')
```

删除光标后的字符

```typescript
univerAPI.executeCommand('doc.command.delete-right')
```

### 修改样式

为选中的文本设置字体色

```typescript
univerAPI.executeCommand('doc.command.set-inline-format-text-color', { value: '#ff0000' })
```

### 插入分页符

`\f` 为分页符，用于在文档中插入分页符。

```typescript
const doc = univerAPI.getActiveDocument()
doc?.appendText('\f')
```

### 插入列表

给光标所在段落添加一个无序列表，重复调用则取消无序列表

```typescript
univerAPI.executeCommand('doc.command.list-operation', { listType: 'BULLET_LIST' })
```

给光标所在段落添加一个有序列表，重复调用则取消有序列表

```typescript
univerAPI.executeCommand('doc.command.list-operation', { listType: 'ORDER_LIST' })
```
